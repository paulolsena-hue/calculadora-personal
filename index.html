<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Heleninha Trainer - Gest√£o</title>
    <!-- Configura√ß√µes para iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Resumo PT">
    
    <style>
        /* Vari√°veis de Tema */
        :root {
            --bg-body: #f3f4f6;
            --bg-card: #ffffff;
            --text-main: #1f2937;
            --text-muted: #4b5563;
            --primary: #4f46e5;
            --primary-hover: #3730a3;
            --border-color: #e5e7eb;
            --result-bg: #111827;
            --result-text: #10b981;
            --modal-overlay: rgba(0, 0, 0, 0.5);
        }

        [data-theme='dark'] {
            --bg-body: #111827;
            --bg-card: #1f2937;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
            --primary: #6366f1;
            --primary-hover: #818cf8;
            --border-color: #374151;
            --result-bg: #000000;
            --result-text: #34d399;
            --modal-overlay: rgba(0, 0, 0, 0.7);
        }

        [data-theme='violet'] {
            --bg-body: #f5f3ff;
            --bg-card: #ffffff;
            --text-main: #4c1d95;
            --text-muted: #6d28d9;
            --primary: #7c3aed;
            --primary-hover: #5b21b6;
            --border-color: #ddd6fe;
            --result-bg: #2e1065;
            --result-text: #a78bfa;
            --modal-overlay: rgba(76, 29, 149, 0.4);
        }

        * { box-sizing: border-box; transition: background-color 0.2s, color 0.2s; -webkit-tap-highlight-color: transparent; }
        html { font-family: 'Inter', -apple-system, sans-serif; }
        body { background-color: var(--bg-body); margin: 0; padding: 15px; color: var(--text-main); line-height: 1.5; }
        .container { max-width: 500px; margin: 0 auto; }

        /* Cabe√ßalho */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        h1 { font-size: 1.1rem; margin: 0; font-weight: 800; }

        /* Bot√µes de A√ß√£o */
        .header-actions { display: flex; gap: 6px; }
        .action-btn { border: 1px solid var(--border-color); background: var(--bg-card); width: 36px; height: 36px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; color: var(--text-main); }

        /* Cart√£o de Configura√ß√£o */
        .card { background: var(--bg-card); padding: 20px; border-radius: 20px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); border: 1px solid var(--border-color); margin-bottom: 20px; }
        .label { display: block; font-size: 0.7rem; font-weight: 800; margin-bottom: 8px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; }
        
        select, .input-styled { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); margin-bottom: 15px; font-size: 1rem; background-color: var(--bg-card); color: var(--text-main); outline: none; }

        /* Stepper de Ano */
        .year-stepper { display: flex; align-items: center; justify-content: space-between; background: var(--bg-body); border-radius: 12px; padding: 6px; margin-bottom: 18px; border: 1px solid var(--border-color); }
        .step-btn { background: var(--primary); color: white; border: none; width: 44px; height: 44px; border-radius: 10px; font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .year-display { font-size: 1.2rem; font-weight: 800; }

        /* Grade de Sess√µes */
        .session-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(65px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .session-box { text-align: center; display: flex; flex-direction: column; align-items: center; }
        .date-label { font-size: 0.75rem; font-weight: 700; margin-bottom: 6px; display: block; color: var(--text-muted); }
        
        /* Seletor Centralizado */
        .session-select {
            -webkit-appearance: none; appearance: none;
            width: 55px; height: 55px; border-radius: 50%; border: none;
            color: white; font-weight: 900; font-size: 1.3rem;
            text-align: center; text-align-last: center; 
            cursor: pointer; padding: 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            display: flex; align-items: center; justify-content: center;
            outline: none;
        }

        .bg-0 { background-color: #ef4444; }
        .bg-1 { background-color: #f59e0b; }
        .bg-2 { background-color: #10b981; }
        .bg-3 { background-color: #3b82f6; }

        /* Resultado e C√≥pia */
        .result-box { background: var(--result-bg); color: var(--result-text); padding: 18px; border-radius: 15px; font-family: 'Courier New', monospace; font-size: 0.95rem; white-space: pre-wrap; margin-bottom: 15px; min-height: 100px; border: 1px solid var(--primary); line-height: 1.4; }
        .copy-btn { width: 100%; background-color: var(--primary); color: white; padding: 18px; border: none; border-radius: 15px; font-weight: 800; font-size: 1.1rem; cursor: pointer; box-shadow: 0 4px 14px rgba(79, 70, 229, 0.4); }
        .copy-btn:active { transform: translateY(2px); box-shadow: none; }

        /* Modal de Configura√ß√µes */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--modal-overlay); display: none; align-items: center; justify-content: center; z-index: 200; padding: 20px; backdrop-filter: blur(4px); }
        .modal-content { background: var(--bg-card); width: 100%; max-width: 400px; border-radius: 25px; padding: 25px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border: 1px solid var(--border-color); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-weight: 800; font-size: 1.2rem; }
        .close-modal { font-size: 1.5rem; cursor: pointer; background: none; border: none; color: var(--text-main); }
        .price-input-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .price-input-row span { flex: 1; font-weight: 700; font-size: 0.9rem; }
        .price-input-row input { flex: 1; margin-bottom: 0; text-align: right; font-weight: 800; }

        /* Mensagem flutuante */
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 12px 24px; border-radius: 30px; font-size: 0.9rem; font-weight: bold; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 300; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>üí™ HELENINHA TRAINER</h1>
            <div class="header-actions">
                <button class="action-btn" onclick="toggleSettings()" title="Ajustar Pre√ßos">‚öôÔ∏è</button>
                <button class="action-btn" onclick="cycleTheme()" id="theme-icon">‚òÄÔ∏è</button>
            </div>
        </header>

        <div class="card">
            <span class="label">M√™s</span>
            <select id="month-select" onchange="generateDates()"></select>

            <span class="label">Ano</span>
            <div class="year-stepper">
                <button class="step-btn" onclick="changeYear(-1)">‚àí</button>
                <span id="year-display" class="year-display">2025</span>
                <button class="step-btn" onclick="changeYear(1)">+</button>
            </div>

            <span class="label">Dia da Aula</span>
            <select id="day-select" onchange="generateDates()">
                <option value="1">Segunda-feira</option>
                <option value="2">Ter√ßa-feira</option>
                <option value="3">Quarta-feira</option>
                <option value="4">Quinta-feira</option>
                <option value="5">Sexta-feira</option>
                <option value="6">S√°bado</option>
                <option value="0">Domingo</option>
            </select>

            <span class="label">N¬∫ Alunos (Toque para alterar)</span>
            <div id="session-container" class="session-grid"></div>
        </div>

        <div class="label">Resumo para Enviar:</div>
        <div id="result-text" class="result-box"></div>
        
        <button class="copy-btn" onclick="copyToClipboard()">COPIAR PARA WHATSAPP</button>

        <div id="toast" class="toast">‚úì Copiado com sucesso!</div>
    </div>

    <!-- Modal de Configura√ß√µes -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">‚öôÔ∏è Configura√ß√µes</span>
                <button class="close-modal" onclick="toggleSettings()">√ó</button>
            </div>
            <span class="label">Valores dos Pacotes (Sess√£o)</span>
            
            <div class="price-input-row">
                <span>Solo (1 Aluno):</span>
                <input type="number" id="price-1" class="input-styled" placeholder="75" onchange="saveSettings()">
            </div>
            <div class="price-input-row">
                <span>Duo (2 Alunos):</span>
                <input type="number" id="price-2" class="input-styled" placeholder="95" onchange="saveSettings()">
            </div>
            <div class="price-input-row">
                <span>Trio (3 Alunos):</span>
                <input type="number" id="price-3" class="input-styled" placeholder="115" onchange="saveSettings()">
            </div>

            <p style="font-size: 0.65rem; color: var(--text-muted); margin-top: 15px; text-align: center;">
                * Os valores alterados aplicam-se imediatamente ao resumo.
            </p>
            <button class="copy-btn" style="margin-top: 10px; background-color: var(--text-main);" onclick="toggleSettings()">FECHAR</button>
        </div>
    </div>

    <script>
        const MONTH_NAMES = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
        const THEMES = ['light', 'dark', 'violet'];
        
        let prices = { 1: 75, 2: 95, 3: 115 };
        let currentSessions = [];
        let currentYear = new Date().getFullYear();
        let currentThemeIndex = 0;

        window.onload = () => {
            // Carregar Configura√ß√µes
            const savedSettings = localStorage.getItem('heleninha_settings');
            if (savedSettings) {
                prices = JSON.parse(savedSettings);
            }
            document.getElementById('price-1').value = prices[1];
            document.getElementById('price-2').value = prices[2];
            document.getElementById('price-3').value = prices[3];

            // Carregar Tema
            const savedTheme = localStorage.getItem('heleninha_theme') || 'light';
            setTheme(savedTheme);
            currentThemeIndex = THEMES.indexOf(savedTheme);

            const now = new Date();
            const monthSelect = document.getElementById('month-select');
            MONTH_NAMES.forEach((m, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                opt.text = m;
                if(i === now.getMonth()) opt.selected = true;
                monthSelect.appendChild(opt);
            });
            
            updateYearDisplay();
            
            const savedConfig = localStorage.getItem('heleninha_config_v4');
            if(savedConfig) {
                const data = JSON.parse(savedConfig);
                document.getElementById('day-select').value = data.day;
                currentYear = data.year || currentYear;
                updateYearDisplay();
            }

            generateDates();
        };

        function toggleSettings() {
            const modal = document.getElementById('settings-modal');
            modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
        }

        function saveSettings() {
            prices[1] = parseFloat(document.getElementById('price-1').value) || 0;
            prices[2] = parseFloat(document.getElementById('price-2').value) || 0;
            prices[3] = parseFloat(document.getElementById('price-3').value) || 0;
            localStorage.setItem('heleninha_settings', JSON.stringify(prices));
            updateResult();
        }

        function cycleTheme() {
            currentThemeIndex = (currentThemeIndex + 1) % THEMES.length;
            const theme = THEMES[currentThemeIndex];
            setTheme(theme);
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('heleninha_theme', theme);
            const icons = { 'light': '‚òÄÔ∏è', 'dark': 'üåô', 'violet': 'üîÆ' };
            document.getElementById('theme-icon').innerText = icons[theme];
        }

        function changeYear(delta) {
            currentYear += delta;
            updateYearDisplay();
            generateDates();
        }

        function updateYearDisplay() {
            document.getElementById('year-display').innerText = currentYear;
        }

        function generateDates() {
            const month = parseInt(document.getElementById('month-select').value);
            const targetDay = parseInt(document.getElementById('day-select').value);
            
            currentSessions = [];
            let date = new Date(currentYear, month, 1);
            
            while (date.getMonth() === month) {
                if (date.getDay() === targetDay) {
                    const d = String(date.getDate()).padStart(2, '0');
                    const m = String(date.getMonth() + 1).padStart(2, '0');
                    currentSessions.push({ date: `${d}/${m}`, students: 3 });
                }
                date.setDate(date.getDate() + 1);
            }

            renderSelectors();
            updateResult();
            
            localStorage.setItem('heleninha_config_v4', JSON.stringify({ 
                day: targetDay, 
                year: currentYear 
            }));
        }

        function renderSelectors() {
            const container = document.getElementById('session-container');
            container.innerHTML = '';
            currentSessions.forEach((s, i) => {
                const div = document.createElement('div');
                div.className = 'session-box';
                div.innerHTML = `
                    <span class="date-label">${s.date}</span>
                    <select class="session-select bg-${s.students}" onchange="updateAttendance(${i}, this.value)">
                        <option value="0" ${s.students === 0 ? 'selected' : ''}>0</option>
                        <option value="1" ${s.students === 1 ? 'selected' : ''}>1</option>
                        <option value="2" ${s.students === 2 ? 'selected' : ''}>2</option>
                        <option value="3" ${s.students === 3 ? 'selected' : ''}>3</option>
                    </select>
                `;
                container.appendChild(div);
            });
        }

        function updateAttendance(index, value) {
            currentSessions[index].students = parseInt(value);
            renderSelectors();
            updateResult();
        }

        function updateResult() {
            const monthIndex = document.getElementById('month-select').value;
            const monthName = MONTH_NAMES[monthIndex];
            let total = 0;
            
            let lines = `üóìÔ∏è *${monthName.toUpperCase()} / ${currentYear}*\n\n`;
            
            currentSessions.forEach(s => {
                if(s.students > 0) {
                    const price = prices[s.students];
                    total += price;
                    lines += `${s.date} - ${s.students} aluno(s) (R$ ${price})\n`;
                } else {
                    lines += `${s.date} - Sem aula / Falta\n`;
                }
            });

            lines += `\nüí∞ *TOTAL: R$ ${total.toFixed(2).replace('.', ',')}*`;
            document.getElementById('result-text').innerText = lines;
        }

        function copyToClipboard() {
            const text = document.getElementById('result-text').innerText;
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            
            try {
                document.execCommand('copy');
                const toast = document.getElementById('toast');
                toast.style.opacity = '1';
                setTimeout(() => toast.style.opacity = '0', 2000);
            } catch (err) {
                console.error('Erro ao copiar texto');
            }
            
            document.body.removeChild(el);
        }
    </script>
</body>
</html>
